<!DOCTYPE html>
<html>
    <head>
        <title>Uceni se s D3js</title>
        <meta charset="windows-1250">

        <script src="http://service.ihned.cz/js/modernizr/v2.6.2.svg.min.js"></script>
        <script src="http://service.ihned.cz/js/jquery.min.js"></script>
        <script src="http://service.ihned.cz/js/d3/v3.2.8.min.js"></script>

        <style>		
            div.bar {
                display: inline-block;
                width: 20px;
                height: 75px;	/* Gets overriden by D3-assigned height below */
                margin-right: 2px;
                background-color: teal;
            }
            .container.c1 div.bar {
                background-color: red;
            }
        </style>

    </head>
    <body>

        <script>
            function pocet() {
                var data_popisek = [];
                var data_veu = [];
                var data_mimoeu = [];
                // ----------------------------------------------------
                d3.tsv("data/data.tsv", function(error, data) {
                    data.forEach(function(d) {
                        d.Kvartal;
                        d.Rok = +d.Rok; // +d (pretypovani na cislo v JavaScriptu)
                        d["v EU"] = +d["v EU"];
                        d["mimo EU"] = +d["mimo EU"];

                        data_popisek.push(d.Kvartal + " " + d.Rok);
                        data_veu.push(d["v EU"]);
                        data_mimoeu.push(d["mimo EU"]);
                    });

                    console.log(data_popisek);
                    console.log(data_veu);
                    console.log(data_mimoeu);

                    d3.select("body").selectAll("div.container")
                            .data([data_veu, data_mimoeu])
                            .enter()
                            .append("div")
                            .attr("class", function(d, index) {
                        return ("container c" + index);
                    })

                            .selectAll("div.container")
                            .data(function(d) {
                        return d;
                    })
                            .enter()
                            .append("div")
                            .attr("class", "bar")

                            .style("height", function(d) {
                        var barHeight = d * 5;
                        return barHeight + "px";
                    });

                });

            }

            function procenta() {
                var data_popisek = [];
                var data_veu = [];
                var data_mimoeu = [];
                // ----------------------------------------------------
                d3.tsv("data/data.tsv", function(error, data) {
                    data.forEach(function(d) {
                        d.Kvartal;
                        d.Rok = +d.Rok; // +d (pretypovani na cislo v JavaScriptu)
                        d["v EU"] = +d["v EU"];
                        d["mimo EU"] = +d["mimo EU"];

                        data_popisek.push(d.Kvartal + " " + d.Rok);
                        data_veu.push(d["v EU"]);
                        data_mimoeu.push(d["mimo EU"]);
                    });


                    d3.select("body").selectAll("div.container")
                            .data([data_veu])
                            .enter()
                            .append("div")
                            .attr("class", "bar")

                            .style("height", function(d) {
                        var barHeight = d * 5;
                        return barHeight + "px";
                    });

                });

            }
        </script>
        <div id="menu">
            <input class="buttonbox" id="pocet" name="group" type="radio">
            <label for="pocet"><span></span>Pocet</label>
            <br>
            <input class="buttonbox" id="procenta" name="group" type="radio">
            <label for="procenta"><span></span>Procenta</label>
        </div>

        <script>
            // Defaultne vybere prvni select box
            $('input:radio:first-child').attr('checked', true);
            
            // Zavola funkci pomoci ID tlacitka
            function callFce(cmd) {
                switch (cmd) {
                    case "pocet":
                        pocet();
                        break;
                    case "procenta":
                        procenta();
                        break;
                }
            }
            
            // Vytahne aktualni vybrany boxik
            $("input:checked").each(function() {
                var id = $(this).attr('id');
                callFce(id);
            });
            // Pri kliku vybere novy boxik
            $(".buttonbox").click(function() {
                var id = $(this).attr('id');
                callFce(id);
            });
        </script>
    </body>
</html>
